!function(){var t=angular.module("chanchito",["chanchito.urls","chanchito.apiFactory","chanchito.logInFactory","chanchito.logInController","chanchito.profileController","chanchito.tabsController","chanchito.movementsController"]);t.config(["$httpProvider",function(t){t.interceptors.push("TokenInterceptor")}]),t.run(["$rootScope","$location","$window","AuthenticationService",function(t,e,o,n){n.isAuthenticated=o.sessionStorage.isAuthenticated,t.$on("$routeChangeStart",function(t,o){try{"/"!==e.path()&&"/login"!==e.path()||!n.isAuthenticated||e.path("/home"),o.access.requiredLogin&&!n.isAuthenticated&&e.path("/")}catch(i){console.log("Redirect: #/")}})}])}(),function(){var t=angular.module("chanchito.urls",["ngRoute"]);t.config(["$routeProvider",function(t){t.when("/working",{templateUrl:"web/dist/templates/working.min.html",access:{requiredLogin:!1}}).when("/login",{templateUrl:"web/dist/templates/login.min.html",controller:"loginController",access:{requiredLogin:!1}}).when("/home",{templateUrl:"web/dist/templates/home.min.html",access:{requiredLogin:!0}}).otherwise({redirectTo:"/working"})}])}(),function(){var t=angular.module("chanchito.logInController",[]);t.controller("loginController",["$http","$location","$window","UserService","AuthenticationService",function(t,e,o,n,i){this.logIn=function(t,r){void 0!==t&&void 0!==r&&n.logIn(t,r).success(function(t){i.isAuthenticated=!0,o.sessionStorage.isAuthenticated=!0,o.sessionStorage.token=t.token,e.path("/home"),console.log("entre")}).error(function(){this.error=!0,console.log("error")})},this.logOut=function(){i.isAuthenticated&&(i.isAuthenticated=!1,delete o.sessionStorage.isAuthenticated,delete o.sessionStorage.token,e.path("/"))}}])}(),function(){var t=angular.module("chanchito.movementsController",[]);t.controller("movementsController",["$scope","$http","chanchitoApi",function(t,e,o){t.serializerDeposit={},t.successDeposit=!1,this.changeDeposit=function(){t.successDeposit&&(t.successDeposit=!1)},this.deposit=function(){var n=e({method:"post",url:o.host+"movements/",data:this.serializerDeposit});n.success(function(e){t.successDeposit=!0,t.serializerDeposit={},console.log(e)}),n.error(function(t){console.log(t)})}}])}(),function(){var t=angular.module("chanchito.profileController",[]);t.controller("profileController",["$scope","$http","chanchitoApi",function(t,e,o){var n=e({method:"get",url:o.host+"token/user/"});n.success(function(e){t.user=e}),n.error(function(){})}])}(),function(){var t=angular.module("chanchito.tabsController",[]);t.controller("tabsController",["$scope",function(t){t.tabs=[{title:"Home",url:""},{title:"Withdraw",url:"web/dist/templates/withdraw.min.html"},{title:"Deposit",url:"web/dist/templates/deposit.min.html"},{title:"Movements",url:"web/dist/templates/movements.min.html"}],t.currentTab="",t.onClickTab=function(e){t.currentTab=e.url},t.isActiveTab=function(e){return e==t.currentTab}}])}(),function(){var t=angular.module("chanchito.apiFactory",[]);t.factory("chanchitoApi",function(){return{host:"http://formatcom.alwaysdata.net/chanchito/api/"}})}(),function(){var t=angular.module("chanchito.logInFactory",[]);t.factory("AuthenticationService",function(){var t={isAuthenticated:!1};return t}),t.factory("UserService",["$http","chanchitoApi",function(t,e){return{logIn:function(o,n){return t({method:"post",url:e.host+"token/",data:{username:o,password:n}})}}}]),t.factory("TokenInterceptor",["$q","$window","$location","AuthenticationService",function(t,e,o,n){return{request:function(t){return t.headers=t.headers||{},e.sessionStorage.token&&(t.headers.Authorization="token "+e.sessionStorage.token),t},requestError:function(e){return t.reject(e)},response:function(o){return null!=o&&200==o.status&&e.sessionStorage.token&&!n.isAuthenticated&&(n.isAuthenticated=!0),o||t.when(o)},responseError:function(i){return null!=i&&401===i.status&&(e.sessionStorage.token||n.isAuthenticated)&&(delete e.sessionStorage.token,delete e.sessionStorage.isAuthenticated,n.isAuthenticated=!1,o.path("/")),t.reject(i)}}}])}();