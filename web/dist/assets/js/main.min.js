!function(){var t=angular.module("chanchito",["chanchito.urls","chanchito.apiFactory","chanchito.logInFactory","chanchito.logInController","chanchito.profileController","chanchito.tabsController","chanchito.movementsController"]);t.config(["$httpProvider",function(t){t.interceptors.push("TokenInterceptor")}]),t.run(["$rootScope","$location","$window","AuthenticationService",function(t,o,n,c){c.isAuthenticated=n.sessionStorage.isAuthenticated,t.$on("$routeChangeStart",function(t,n){try{"/"!==o.path()&&"/login"!==o.path()||!c.isAuthenticated||o.path("/home"),n.access.requiredLogin&&!c.isAuthenticated&&o.path("/")}catch(e){console.log("Redirect: #/")}})}])}();
!function(){var e=angular.module("chanchito.urls",["ngRoute"]);e.config(["$routeProvider",function(e){e.when("/working",{templateUrl:"web/dist/templates/working.min.html",access:{requiredLogin:!1}}).when("/login",{templateUrl:"web/dist/templates/login.min.html",controller:"loginController as logInCtrl",access:{requiredLogin:!1}}).when("/home",{templateUrl:"web/dist/templates/home.min.html",access:{requiredLogin:!0}}).otherwise({redirectTo:"/working"})}])}();
!function(){var t=angular.module("chanchito.logInController",[]);t.controller("loginController",["$http","$location","$window","UserService","AuthenticationService",function(t,e,o,n,i){this.logIn=function(t,s){void 0!==t&&void 0!==s&&n.logIn(t,s).success(function(t){i.isAuthenticated=!0,o.sessionStorage.isAuthenticated=!0,o.sessionStorage.token=t.token,e.path("/home")}).error(function(){this.error=!0})},this.logOut=function(){i.isAuthenticated&&(i.isAuthenticated=!1,delete o.sessionStorage.isAuthenticated,delete o.sessionStorage.token,e.path("/"))}}])}();
!function(){var s=angular.module("chanchito.movementsController",[]);s.controller("movementsController",["$http","chanchitoApi",function(s,e){self=this,this.serializerDeposit={},this.successDeposit=!1,this.changeDeposit=function(){this.successDeposit&&(this.successDeposit=!1)},this.deposit=function(){var o=s({method:"post",url:e.host+"movements/",data:this.serializerDeposit});o.success(function(s){self.successDeposit=!0,self.serializerDeposit={},console.log(s)}),o.error(function(s){console.log(s)})}}])}();
!function(){var o=angular.module("chanchito.profileController",[]);o.controller("profileController",["$http","chanchitoApi",function(o,r){self=this;var t=o({method:"get",url:r.host+"token/user/"});t.success(function(o){self.user=o}),t.error(function(){})}])}();
!function(){var t=angular.module("chanchito.tabsController",[]);t.controller("tabsController",function(){this.tabs=[{title:"Home",url:""},{title:"Withdraw",url:"web/dist/templates/withdraw.min.html"},{title:"Deposit",url:"web/dist/templates/deposit.min.html"},{title:"Movements",url:"web/dist/templates/movements.min.html"}],this.currentTab="",this.onClickTab=function(t){this.currentTab=t.url},this.isActiveTab=function(t){return t==this.currentTab}})}();
!function(){var a=angular.module("chanchito.apiFactory",[]);a.factory("chanchitoApi",function(){return{host:"http://formatcom.alwaysdata.net/chanchito/api/"}})}();
!function(){var t=angular.module("chanchito.logInFactory",[]);t.factory("AuthenticationService",function(){var t={isAuthenticated:!1};return t}),t.factory("UserService",["$http","chanchitoApi",function(t,e){return{logIn:function(n,o){return t({method:"post",url:e.host+"token/",data:{username:n,password:o}})}}}]),t.factory("TokenInterceptor",["$q","$window","$location","AuthenticationService",function(t,e,n,o){return{request:function(t){return t.headers=t.headers||{},e.sessionStorage.token&&(t.headers.Authorization="token "+e.sessionStorage.token),t},requestError:function(e){return t.reject(e)},response:function(n){return null!=n&&200==n.status&&e.sessionStorage.token&&!o.isAuthenticated&&(o.isAuthenticated=!0),n||t.when(n)},responseError:function(r){return null!=r&&401===r.status&&(e.sessionStorage.token||o.isAuthenticated)&&(delete e.sessionStorage.token,delete e.sessionStorage.isAuthenticated,o.isAuthenticated=!1,n.path("/")),t.reject(r)}}}])}();